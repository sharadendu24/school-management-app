<div class="forgot-password-container">
    <p-card *ngIf="step === 1" header="Forgot Password" class="card">
      <p class="text-500">Enter your username to receive a password reset code</p>
      
      <div class="field">
        <label for="username">Username</label>
        <input 
          type="text" 
          pInputText 
          id="username" 
          [(ngModel)]="username"
          [disabled]="loading"
        >
      </div>
  
      <div class="flex justify-content-end mt-4">
        <p-button 
          label="Send Code"
          [loading]="loading"
          (onClick)="requestResetCode(username)"
          [disabled]="!username"
        ></p-button>
      </div>
    </p-card>
  
    <p-card *ngIf="step === 2" header="Reset Password" class="card">
      <p class="text-500">Enter the verification code and new password</p>
  
      <form [formGroup]="resetForm">
        <div class="field">
          <label for="confirmationCode">Verification Code</label>
          <input 
            type="text" 
            pInputText 
            id="confirmationCode" 
            formControlName="confirmationCode"
          >
        </div>
  
        <div class="field">
          <label for="newPassword">New Password</label>
          <p-password 
            id="newPassword" 
            formControlName="newPassword"
            [feedback]="false"
            [toggleMask]="true"
          ></p-password>
        </div>

        <div *ngIf="resetForm.get('newPassword')?.hasError('pattern')" class="error-message">
          Password must contain:
          <ul>
            <li>Minimum 8 characters</li>
            <li>At least 1 uppercase letter</li>
            <li>At least 1 lowercase letter</li>
            <li>At least 1 number</li>
            <li>At least 1 special character.</li>
          </ul>
        </div>

      

        <div class="field">
          <label for="confirmNewPassword">Confirm New Password</label>
          <p-password 
            id="confirmNewPassword" 
            formControlName="confirmNewPassword"
            [toggleMask]="true"
          ></p-password>
        </div>

        <div *ngIf="resetForm.hasError('passwordMismatch')" class="error-message">
          Passwords do not match
        </div>
  
        <div class="flex justify-content-between mt-4">
          <p-button 
            label="Back"
            icon="pi pi-arrow-left"
            severity="secondary"
            (onClick)="step = 1"
          ></p-button>
          
          <p-button 
            label="Reset Password"
            [loading]="loading"
            (onClick)="confirmReset()"
            [disabled]="resetForm.invalid"
          ></p-button>
        </div>
      </form>
    </p-card>
  </div>
  
  <p-toast></p-toast>